<h1 id="pixi-live2d-display">pixi-live2d-display</h1>
<p><img
src="https://img.shields.io/github/package-json/v/guansss/pixi-live2d-display?style=flat-square"
alt="GitHub package.json version" /> <img
src="https://img.shields.io/badge/Cubism-2/3/4-ff69b4?style=flat-square"
alt="Cubism version" /> <img
src="https://img.shields.io/github/workflow/status/guansss/pixi-live2d-display/Test%20CI?style=flat-square"
alt="GitHub Workflow Status" /></p>
<p>English | <a href="README.zh.md">中文</a></p>
<blockquote>
<p>:warning: This readme is for v0.4.0, if you're looking for v0.3.1,
see <a
href="https://github.com/guansss/pixi-live2d-display/blob/dfa7f764f241c1c802e92a7ab490206369746efd/README.md">this</a>.</p>
</blockquote>
<p>Live2D integration for <a
href="https://github.com/pixijs/pixi.js">PixiJS</a> v6.</p>
<p>This project aims to be a universal Live2D framework on the web
platform. While the official Live2D framework is just complex and
problematic, this project has rewritten it to unify and simplify the
APIs, which allows you to control the Live2D models on a high level
without the need to learn how the internal system works.</p>
<h4 id="features">Features</h4>
<ul>
<li>Supports all versions of Live2D models</li>
<li>Supports PIXI.RenderTexture and PIXI.Filter</li>
<li>Pixi-style transform APIs: position, scale, rotation, skew,
anchor</li>
<li>Automatic interactions: focusing, hit-testing</li>
<li>Enhanced motion reserving logic compared to the official
framework</li>
<li>Loading from uploaded files / zip files (experimental)</li>
<li>Fully typed - we all love types!</li>
</ul>
<h4 id="requirements">Requirements</h4>
<ul>
<li>PixiJS: &gt;6</li>
<li>Browser: WebGL, ES6</li>
</ul>
<h4 id="demos">Demos</h4>
<ul>
<li><a
href="https://codepen.io/guansss/pen/oNzoNoz/left?editors=1010">Basic
demo</a></li>
<li><a
href="https://codepen.io/guansss/pen/KKgXBOP/left?editors=0010">Interaction
demo</a></li>
<li><a
href="https://codepen.io/guansss/pen/qBaMNQV/left?editors=1010">Render
texture &amp; filter demo</a></li>
<li><a href="https://guansss.github.io/live2d-viewer-web/">Live2D Viewer
Online</a></li>
</ul>
<h4 id="documentations">Documentations</h4>
<ul>
<li><a
href="https://guansss.github.io/pixi-live2d-display">Documentation</a></li>
<li><a
href="https://guansss.github.io/pixi-live2d-display/api/index.html">API
Documentation</a></li>
</ul>
<h2 id="cubism">Cubism</h2>
<p>Cubism is the name of Live2D SDK. There are so far three versions of
it: Cubism 2.1, Cubism 3 and Cubism 4; where Cubism 4 is
backward-compatible with Cubism 3 models.</p>
<p>This plugin supports all variants of Live2D models by using Cubism
2.1 and Cubism 4.</p>
<h4 id="cubism-core">Cubism Core</h4>
<p>Before using the plugin, you'll need to include the Cubism runtime
library, aka Cubism Core.</p>
<p>For Cubism 4, you need <code>live2dcubismcore.min.js</code> that can
be extracted from the <a
href="https://www.live2d.com/download/cubism-sdk/download-web/">Cubism 4
SDK</a>, or be referred by a <a
href="https://cubism.live2d.com/sdk-web/cubismcore/live2dcubismcore.min.js">direct
link</a> (<em>however the direct link is quite unreliable, don't use it
in production!</em>).</p>
<p>For Cubism 2.1, you need <code>live2d.min.js</code>. It's no longer
downloadable from the official site <a
href="https://help.live2d.com/en/other/other_20/">since 2019/9/4</a>,
but can be found <a
href="https://github.com/dylanNew/live2d/tree/master/webgl/Live2D/lib">here</a>,
and with a <a
href="https://cdn.jsdelivr.net/gh/dylanNew/live2d/webgl/Live2D/lib/live2d.min.js">CDN
link</a> that you'll probably need.</p>
<h4 id="individual-bundles">Individual Bundles</h4>
<p>The plugin provides individual bundles for each Cubism version to
reduce your app's size when you just want to use one of the
versions.</p>
<p>Specifically, there are <code>cubism2.js</code> and
<code>cubism4.js</code> for respective runtime, along with an
<code>index.js</code> that includes both of them.</p>
<p>Note that if you want both the Cubism 2.1 and Cubism 4 support, use
<code>index.js</code>, but <em>not</em> the combination of
<code>cubism2.js</code> and <code>cubism4.js</code>.</p>
<p>To make it clear, here's how you would use these files:</p>
<ul>
<li>Use <code>cubism2.js</code>+<code>live2d.min.js</code> to support
Cubism 2.1 models</li>
<li>Use <code>cubism4.js</code>+<code>live2dcubismcore.min.js</code> to
support Cubism 3 and Cubism 4 models</li>
<li>Use
<code>index.js</code>+<code>live2d.min.js</code>+<code>live2dcubismcore.min.js</code>
to support all versions of models</li>
</ul>
<h2 id="installation">Installation</h2>
<h4 id="via-npm">Via npm</h4>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> install pixi-live2d-display</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { Live2DModel } <span class="im">from</span> <span class="st">&#39;pixi-live2d-display&#39;</span><span class="op">;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">// if only Cubism 2.1</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { Live2DModel } <span class="im">from</span> <span class="st">&#39;pixi-live2d-display/cubism2&#39;</span><span class="op">;</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">// if only Cubism 4</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { Live2DModel } <span class="im">from</span> <span class="st">&#39;pixi-live2d-display/cubism4&#39;</span><span class="op">;</span></span></code></pre></div>
<h4 id="via-cdn">Via CDN</h4>
<div class="sourceCode" id="cb3"><pre
class="sourceCode html"><code class="sourceCode html"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">script</span><span class="ot"> src</span><span class="op">=</span><span class="st">&quot;https://cdn.jsdelivr.net/npm/pixi-live2d-display/dist/index.min.js&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">script</span><span class="dt">&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- if only Cubism 2.1 --&gt;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">script</span><span class="ot"> src</span><span class="op">=</span><span class="st">&quot;https://cdn.jsdelivr.net/npm/pixi-live2d-display/dist/cubism2.min.js&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">script</span><span class="dt">&gt;</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- if only Cubism 4 --&gt;</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">script</span><span class="ot"> src</span><span class="op">=</span><span class="st">&quot;https://cdn.jsdelivr.net/npm/pixi-live2d-display/dist/cubism4.min.js&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">script</span><span class="dt">&gt;</span></span></code></pre></div>
<p>In this way, all the exported members are available under
<code>PIXI.live2d</code> namespace, such as
<code>PIXI.live2d.Live2DModel</code>.</p>
<h2 id="basic-usage">Basic usage</h2>
<div class="sourceCode" id="cb4"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> <span class="op">*</span> <span class="im">as</span> PIXI <span class="im">from</span> <span class="st">&#39;pixi.js&#39;</span><span class="op">;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { Live2DModel } <span class="im">from</span> <span class="st">&#39;pixi-live2d-display&#39;</span><span class="op">;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">// expose PIXI to window so that this plugin is able to</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">// reference window.PIXI.Ticker to automatically update Live2D models</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="bu">window</span><span class="op">.</span><span class="at">PIXI</span> <span class="op">=</span> PIXI<span class="op">;</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>(<span class="kw">async</span> <span class="kw">function</span> () {</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> app <span class="op">=</span> <span class="kw">new</span> PIXI<span class="op">.</span><span class="fu">Application</span>({</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">view</span><span class="op">:</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;canvas&#39;</span>)<span class="op">,</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> model <span class="op">=</span> <span class="cf">await</span> Live2DModel<span class="op">.</span><span class="fu">from</span>(<span class="st">&#39;shizuku.model.json&#39;</span>)<span class="op">;</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    app<span class="op">.</span><span class="at">stage</span><span class="op">.</span><span class="fu">addChild</span>(model)<span class="op">;</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">// transforms</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    model<span class="op">.</span><span class="at">x</span> <span class="op">=</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    model<span class="op">.</span><span class="at">y</span> <span class="op">=</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    model<span class="op">.</span><span class="at">rotation</span> <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span><span class="op">;</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    model<span class="op">.</span><span class="at">skew</span><span class="op">.</span><span class="at">x</span> <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span><span class="op">;</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    model<span class="op">.</span><span class="at">scale</span><span class="op">.</span><span class="fu">set</span>(<span class="dv">2</span><span class="op">,</span> <span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    model<span class="op">.</span><span class="at">anchor</span><span class="op">.</span><span class="fu">set</span>(<span class="fl">0.5</span><span class="op">,</span> <span class="fl">0.5</span>)<span class="op">;</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    <span class="co">// interaction</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>    model<span class="op">.</span><span class="fu">on</span>(<span class="st">&#39;hit&#39;</span><span class="op">,</span> (hitAreas) <span class="kw">=&gt;</span> {</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (hitAreas<span class="op">.</span><span class="fu">includes</span>(<span class="st">&#39;body&#39;</span>)) {</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>            model<span class="op">.</span><span class="fu">motion</span>(<span class="st">&#39;tap_body&#39;</span>)<span class="op">;</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>})()<span class="op">;</span></span></code></pre></div>
<h2 id="package-importing">Package importing</h2>
<p>When importing Pixi packages on-demand, you may need to manually
register some plugins to enable optional features.</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { Application } <span class="im">from</span> <span class="st">&#39;@pixi/app&#39;</span><span class="op">;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { Ticker<span class="op">,</span> TickerPlugin } <span class="im">from</span> <span class="st">&#39;@pixi/ticker&#39;</span><span class="op">;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { InteractionManager } <span class="im">from</span> <span class="st">&#39;@pixi/interaction&#39;</span><span class="op">;</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { Live2DModel } <span class="im">from</span> <span class="st">&#39;pixi-live2d-display&#39;</span><span class="op">;</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">// register Ticker for Live2DModel</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>Live2DModel<span class="op">.</span><span class="fu">registerTicker</span>(Ticker)<span class="op">;</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">// register Ticker for Application</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>Application<span class="op">.</span><span class="fu">registerPlugin</span>(TickerPlugin)<span class="op">;</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">// register InteractionManager to make Live2D models interactive</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>Renderer<span class="op">.</span><span class="fu">registerPlugin</span>(<span class="st">&#39;interaction&#39;</span><span class="op">,</span> InteractionManager)<span class="op">;</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>(<span class="kw">async</span> <span class="kw">function</span> () {</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> app <span class="op">=</span> <span class="kw">new</span> <span class="fu">Application</span>({</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>        <span class="dt">view</span><span class="op">:</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;canvas&#39;</span>)<span class="op">,</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> model <span class="op">=</span> <span class="cf">await</span> Live2DModel<span class="op">.</span><span class="fu">from</span>(<span class="st">&#39;shizuku.model.json&#39;</span>)<span class="op">;</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    app<span class="op">.</span><span class="at">stage</span><span class="op">.</span><span class="fu">addChild</span>(model)<span class="op">;</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>})()<span class="op">;</span></span></code></pre></div>
<hr />
<p>The example Live2D models, Shizuku (Cubism 2.1) and Haru (Cubism 4),
are redistributed under Live2D's <a
href="https://www.live2d.com/eula/live2d-free-material-license-agreement_en.html">Free
Material License</a>.</p>
